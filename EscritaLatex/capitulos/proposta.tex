\chapter{Proposta}

\section{Requisitos Funcionais}
\subsection{Estórias de Usuário}
\textbf{US1 - Expert Correlação Linear}

Como pesquisador, gostaria de usar o método de Correlação de Pearson para verificar sua eficácia no Mercado de Moedas.

Critérios de aceitação US1:
\begin{itemize}
\item A Correlação de Pearson deve ser maior que 0.8 e o mercado estar subindo para se realizar a venda;
\item A Correlação de Pearson deve ser maior que 0.8 e o mercado estar caindo para se realizar a compra;
\item O take profit e o stop loss devem ser os mesmos.
\end{itemize}

\textbf{US2 - Expert Fibonacci}
Como pesquisador, gostaria de usar o método de Fibonacci para verificar sua eficácia no Mercado de Moedas.

Critérios de aceitação US2:
\begin{itemize}
\item Na situação em que o mercado estiver caindo e a regressão de Fibonacci estiver em 0.62, deve-se apenas vender no mercado com take profit e stop loss em 500 pontos;
\item Na situação em que o mercado estiver subindo e a regressão de Fibonacci estiver em 0.62, deve-se apenas comprar no mercado com take profit e stop loss em 500 pontos.
\end{itemize}

\textbf{US3 - Expert Mínimos Quadrados}

Como pesquisador, gostaria de usar o método de Mínimos Quadrados para verificar sua eficácia no Mercado de Moedas.

Critérios de aceitação US3:
\begin{itemize}
\item Não deve existir stop loss ou take profit fixos, pois os mesmos são variáveis de acordo com a estratégia do método de Mínimos Quadrados;
\item O método deve seguir a tendência do mercado. Se o mercado estiver subindo, deve-se comprar e se estiver caindo, deve-se vender.
\end{itemize}

\textbf{US4 - Expert Estocástico}

Como pesquisador, gostaria de usar o método de Estocástico para verificar sua eficácia no Mercado de Moedas.

Critérios de aceitação US4:
\begin{itemize}
\item Com estocástico acima de 0.80, deve-se vender com stop loss e take profit em 500 pontos;
\item Com estocástico acima de 0.20, deve-se comprar com stop loss e take profit em 500 pontos.
\end{itemize}

\textbf{US5 - Expert Média Móvel}

Como pesquisador, gostaria de usar o método de Média Móvel para verificar sua eficácia no Mercado de Moedas.

Critérios de aceitação US5:
\begin{itemize}
\item Se a média móvel lenta (12), cruzar a média rápida (26) de baixo para cima, deve-se comprar;
\item Se a média móvel lenta (12), cruzar a média rápida (26) de cima para baixo, deve-se vender.
\end{itemize}

\section{Arquitetura Orientada a Componentes}

Arquitetura Orientada a Componentes possui o propósito de dividir para conquistar. Um grande problema é quebrado em partes menores e em seguida se desenvolve soluções mais elaboradas \cite{john}.

Por usar vários paradigmas, a ferramenta InvestMVC terá vários componentes e cada componente terá seu paradigma de programação e responsabilidade bem definida, como mostrado na figura \ref{componente}.

\begin{figure}[htp]
\centering
\includegraphics[width=0.9\textwidth]{figuras/componente}
\caption{Diagrama de Sequência InvestMVC}{Fonte:Autores}
\label{componente}
\end{figure}

\subsection{Componente Orientado a Objetos}

Este componente fará a interação com o usuário e será implementado em linguagem Grovvy. A escolha dessa linguagem, se deu porque esta é voltada para aplicações web e juntamente com  o framework grails, fornece a criação de um projeto com uma arquitetura MVC definida, como demonstra a figura \ref{classeOO}.

\begin{figure}[htp]
\centering
\includegraphics[width=0.9\textwidth]{figuras/classeOO}
\caption{Diagrama de Classe InvestMVC componente Orientado a Objetos}{Fonte: Autores} 
\label{classeOO}
\end{figure}

Segundo \citeonline{lamin} na arquitetura MVC o controle de fluxo de dados dentro deste módulo ocorre da seguinte forma:

\begin{enumerate}
\item O usuário,neste caso o investidor, interage com a Visão;
\item A Controladora manipula o evento da interface do usuário através de uma rotina.
\item A Controladora acessa o Model, atualizando-o baseado na interação do usuário.
\end{enumerate}

Conforme mostra a figura \ref{sequenciaOO}

\begin{figure}[htp]
\centering
\includegraphics[width=0.9\textwidth]{figuras/sequenciaOO}
\caption{Diagrama de sequência InvestMVC componente Orientado a Objetos}{Fonte: Autores}
\label{sequenciaOO}
\end{figure}

\subsection{Componente Cálculos Numéricos}

O componente Cálculos Numéricos será responsável por calcular os métodos matemáticos presentes na ferramenta InvestMVC. Este módulo é composto por dois outros módulos: módulo Estruturado e módulo Funcional.

O componente Estruturado da ferramenta InvestMVC será programado em linguagem C e o módulo Funcional em linguagem Haskell. Ambos os componentes irão realizar os mesmos cálculos. Isso aumenta a probabilidade de não ocorrer erros nos cálculos dos Métodos Matemáticos. Caso um dos componentes por algum motivo não seja executado no momento correto, a tendência é que o outro módulo realize os cálculos.

\subsubsection{Componente Funcional}
Por ser uma linguagem de programação funcional sua "gramática" está próxima das funções matemáticas, logo a implementação dos métodos algébricos e numéricos se torna muito intuitiva. \cite{hoogle2013}.

O paradigma funcional é declarativo, por limitar o uso de atribuições à variáveis suas funções são mais precisas do que em outros paradigmas \cite{piponi2006}.

Devido aos fatos externalizados, o paradigma funcional, foi eleito para implementar os Métodos Matemáticos de Correlação Linear, Mínimos Quadrados e Fibonacci. Por ser simples,este componente será formado apenas por seus 4 arquivos haskell, cada arquivo realiza o cálculo de um Método Numérico, com execeção do arquivo  Arquivos.hs, que faz a leitura de arquivos.

\begin{figure}[htp]
\centering
\includegraphics[width=0.5\textwidth]{figuras/componenteFuncional}
\caption{Componente Funcional InvestMVC}{Fonte: Autores} 
\label{componenteFuncional}
\end{figure}

O componente Funcional espera uma socilitação de cálculo do componente Multiagente, logo após a solicitação o componente busca na persistência(um arquivo) as cotações do mercado, com estas cotações o componente é capaz de realizar o cálculo do Método Numérico que é esperado pelo componente Multiagente, como é mostrado na figura \ref{sequenciaFuncional}.

\begin{figure}[htp]
\centering
\includegraphics[width=0.9\textwidth]{figuras/sequenciaFuncional}
\caption{Diagrama de Sequência do Componente Funcional InvestMVC}{Fonte: Autores} 
\label{sequenciaFuncional}
\end{figure}

\subsubsection{Componente Estruturado}

A linguagem de programação C é estruturada e possui a vantagem da velocidade de execução do código fonte. Também é uma linguagem bastante utilizada para realizar cálculos numéricos e algébricos \cite{gustavo}. 

Devido aos fatos externalizados, o paradigma estruturado utilizando a linguagem C, também foi eleito para implementar os Métodos Matemáticos de Correlação Linear, Mínimos Quadrados e Fibonacci.

A arquitetura e sequência do fluxo de dados do Componente Estruturado segue a mesma lógica do Componente Funcional, como ilustrado na figura \ref{sequenciaEstruturado}.

\begin{figure}[htp]
\centering
\includegraphics[width=0.5\textwidth]{figuras/componenteEstruturado}
\includegraphics[width=0.5\textwidth]{figuras/sequenciaEstruturado}
\caption{Diagramas de Componentes e de Sequência do Componente Estruturado InvestMVC.}{Fonte: Autores.} 
\label{sequenciaEstruturado}
\end{figure}

\subsection{Componente Multiagentes}

O componente Multiagente será implementado usando o paradigma Multiagente com linguagem Java. 

Agentes de software são entidades autônomas e com capacidades sociais, o uso deste paradigma justifica-se na tomada de decisões \cite{agentBuilderWhy}. 

Os agentes da ferramenta  InvestMVC possuem uma arquitetura reativa, pois suas ações se dão pelas variações que ocorrem nas cotações do Mercado de Moedas.

A arquitetura do Componente Multiagente está modularizado por pacotes: o pacote comportamentos será formado por compormentos que serão usados pelos Agentes de Software, o pacote metodosNumericos será formado por Agentes que acerão o componente Cálculos Numéricos, o pacote investidores será composto por Agentes que vão interagir com o Componente MQL e o pacote execucao iniciará a execução do SMA.

\begin{figure}[htp]
\centering
\includegraphics[width=0.9\textwidth]{figuras/diagramaClassesSMA}
\caption{Diagrama de Classe do Componente Multiagente InvestMVC}{Fonte: Autores} 
\label{diagramaClassesSMA}
\end{figure}

\subsection{Componente Lógico}

O componente Lógico será produzido em linguagem Prolog e vai definir uma base de conhecimento que servirá como critério de entrada e saída no Mercado de Moedas.

O paradigma Lógico facilita a representação, inserção e recuperação de conhecimento, por isso é muito usado em aplicações com Inteligência Artificial \cite{almeida2010}.

\subsection{Componente MQL}

O componente MQL será responsável por receber a resposta do módulo Multiagentes para realizar uma compra ou venda. Também será recebido outros atributos relacionados a compra ou venda, como alavancagem, stop loss e take profit.

\subsection{Fluxo de atividades  da ferramenta InvestMVC}

O investidor interage apenas com o componente Orientado a Objetos, criando seu usuário e Experts, no qual serão persistidos. Além disso, o investidor também poderá ativar um Expert.

O componente Multiagentes vai verificar a tendência do Mercado de Moedas, por meio da plataforma MetaTrader. Sendo assim, o componente Multiagentes buscará na persistência o Expert que está ativo. Sabendo qual o Expert que foi ativado, o componente Multiagente faz a requisição de cálculos para os módulos C e Haskell. A partir desse resultado, o componente Multiagente procurará no Módulo Base de Conhecimento, a alavancagem (quanto deve arriscar) e os valores de entrada para o método de Correlação de Pearson, Fibonacci e Mínimos Quadrados. Caso todas as especificações para o módulo Multiagentes sejam obedecidas, ele informa ao componente MQL para realizar uma compra ou venda.

\begin{figure}[htp]
\centering
\includegraphics[width=0.9\textwidth]{figuras/sequencia}
\caption{Diagrama de Sequência InvestMVC}{Fonte: Autores} 
\label{sequencia}
\end{figure}
